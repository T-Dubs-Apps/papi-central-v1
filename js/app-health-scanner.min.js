const appUrl=document.getElementById("appUrl"),scanBtn=document.getElementById("scanBtn"),monitorBtn=document.getElementById("monitorBtn"),scanStatus=document.getElementById("scanStatus"),scanResults=document.getElementById("scanResults");let monitoring=!1,monitorInterval=null;async function scanApp(){const t=appUrl.value.trim();if(!t)return void(scanStatus.textContent="Please enter an app URL.");scanStatus.textContent="Scanning app for issues...",scanResults.innerHTML="";let n,e,s=!1;try{n=await fetch(t,{cache:"no-store"}),e=await n.text(),s=n.ok}catch(t){return void(scanStatus.textContent="App is unreachable: "+t.message)}if(!s)return scanStatus.textContent="App is down or returned error.",void(scanResults.innerHTML="<b>Issue:</b> App is not responding.");scanStatus.textContent="App is up. Analyzing for issues...";let o=[];/error|exception|not found|fail|unavailable|crash/i.test(e)&&o.push("Detected error message in app response."),o.length?(scanResults.innerHTML=`<b>Issues found:</b><ul>${o.map(t=>`<li>${t}</li>`).join("")}</ul>`,scanResults.innerHTML+="<button id='fixBtn' class='mt-2 bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded'>Offer Fix</button>",document.getElementById("fixBtn").onclick=async()=>{scanStatus.textContent="Looking for a solution...",setTimeout(()=>{scanResults.innerHTML+="<div class='mt-2'><b>AI Suggestion:</b> Try restarting the app or checking logs. <button id='repairBtn' class='ml-2 bg-green-600 hover:bg-green-700 text-white px-2 py-1 rounded text-xs'>Repair Now</button></div>",document.getElementById("repairBtn").onclick=async()=>{scanStatus.textContent="Repairing (simulated, <20s downtime)...",setTimeout(async()=>{scanStatus.textContent="Double-checking fix...",await scanApp(),scanStatus.textContent="Repair complete. Monitoring for further issues..."},5e3)}},2e3)}):scanResults.innerHTML="<b>No major issues detected.</b>"}scanBtn.onclick=scanApp,monitorBtn.onclick=()=>{monitoring?(clearInterval(monitorInterval),monitoring=!1,monitorBtn.textContent="Start Monitoring",scanStatus.textContent="Monitoring stopped."):(monitoring=!0,monitorBtn.textContent="Stop Monitoring",scanStatus.textContent="Monitoring app every 60 seconds...",monitorInterval=setInterval(scanApp,6e4))};