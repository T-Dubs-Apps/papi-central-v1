<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BETA LINK GENERATOR</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 text-white min-h-screen flex items-center justify-center p-4">
    
    <div class="max-w-2xl w-full">
        <div class="bg-gray-800 border-2 border-purple-500 rounded-xl p-8 shadow-2xl">
            
            <!-- Header -->
            <div class="text-center mb-8">
                <div class="bg-purple-500 w-20 h-20 rounded-full mx-auto mb-4 flex items-center justify-center">
                    <i class="fas fa-link text-4xl"></i>
                </div>
                <h1 class="text-3xl font-bold text-purple-400 mb-2">BETA LINK GENERATOR</h1>
                <p class="text-gray-400">Create shareable activation links for family & friends</p>
            </div>

            <!-- Form -->
            <div class="space-y-4 mb-6">
                <div>
                    <label class="block text-sm font-bold mb-2 text-gray-300">Your Name</label>
                    <input type="text" id="name" placeholder="e.g., John Smith" 
                        class="w-full bg-gray-900 border border-gray-700 text-white p-3 rounded">
                </div>
                
                <div>
                    <label class="block text-sm font-bold mb-2 text-gray-300">Your Email</label>
                    <input type="email" id="email" placeholder="e.g., john@example.com" 
                        class="w-full bg-gray-900 border border-gray-700 text-white p-3 rounded">
                </div>
                
                <div>
                    <label class="block text-sm font-bold mb-2 text-gray-300">Your Phone</label>
                    <input type="tel" id="phone" placeholder="e.g., +1-555-0123" 
                        class="w-full bg-gray-900 border border-gray-700 text-white p-3 rounded">
                </div>
                
                <div>
                    <label class="block text-sm font-bold mb-2 text-gray-300">Select App Access</label>
                    <select id="app" class="w-full bg-gray-900 border border-gray-700 text-white p-3 rounded">
                        <option value="">-- Choose App --</option>
                        <option value="papi">AI Pro ($49.99 value)</option>
                        <option value="automation">Automation Hub ($29.99 value)</option>
                        <option value="aegis">Aegis Guard ($9.99 value)</option>
                        <option value="aegis_gov">Aegis Government ($99.99 value)</option>
                        <option value="callsentry">Call Sentry ($14.99 value)</option>
                        <option value="nk">No Knowledge Kit ($50 value)</option>
                        <option value="bundle" selected>ðŸ”¥ FULL BUNDLE (All Apps - $252.96 value)</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-bold mb-2 text-gray-300">Days Valid</label>
                    <input type="number" id="days" value="30" min="1" max="365"
                        class="w-full bg-gray-900 border border-gray-700 text-white p-3 rounded">
                </div>
            </div>

            <!-- Generate Button -->
            <button onclick="generateLink()" 
                class="w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500 text-white font-bold py-4 rounded-lg mb-6 transition">
                <i class="fas fa-magic mr-2"></i> GENERATE SHARE LINK
            </button>

            <!-- Generated Link Display -->
            <div id="linkResult" class="hidden">
                <div class="bg-gray-900 border border-green-500 rounded-lg p-6 mb-4">
                    <h3 class="font-bold text-green-400 mb-3 flex items-center gap-2">
                        <i class="fas fa-check-circle"></i> Share Link Generated!
                    </h3>
                    <div class="bg-black border border-gray-700 rounded p-3 mb-3 break-all text-xs font-mono text-cyan-400" id="generatedLink"></div>
                    <div class="flex gap-2">
                        <button onclick="copyLink()" class="flex-1 bg-green-600 hover:bg-green-500 text-white font-bold py-2 rounded">
                            <i class="fas fa-copy mr-2"></i> COPY LINK
                        </button>
                        <button onclick="sendEmail()" class="flex-1 bg-blue-600 hover:bg-blue-500 text-white font-bold py-2 rounded">
                            <i class="fas fa-envelope mr-2"></i> EMAIL IT
                        </button>
                    </div>
                </div>

                <!-- Preview -->
                <div class="bg-gray-900/50 border border-gray-700 rounded-lg p-4">
                    <h4 class="font-bold text-gray-300 mb-2 text-sm">Message Preview:</h4>
                    <div id="messagePreview" class="text-sm text-gray-400 italic"></div>
                </div>
            </div>

            <!-- Info -->
            <div class="mt-6 p-4 bg-purple-900/30 border border-purple-500/30 rounded-lg text-xs text-gray-400">
                <div class="flex gap-2 items-start">
                    <i class="fas fa-info-circle text-purple-400 mt-1"></i>
                    <div>
                        <strong class="text-purple-400">How it works:</strong> The recipient clicks your link â†’ 
                        License automatically activates â†’ They get FREE access for the specified days. 
                        <strong class="text-green-400">Only you can generate these links!</strong>
                    </div>
                </div>
            </div>

            <!-- Back -->
            <div class="mt-6 text-center">
                <a href="beta-admin.html" class="text-gray-400 hover:text-white transition">
                    <i class="fas fa-arrow-left mr-2"></i> Back to Beta Admin
                </a>
            </div>

        </div>
    </div>

    <script>
        let currentLink = '';
        let currentMessage = '';

        function generateLink() {
            const name = document.getElementById('name').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const app = document.getElementById('app').value;
            const days = document.getElementById('days').value;

            // Validation
            if (!name) {
                alert('Please enter a name');
                return;
            }
            if (!email) {
                alert('Please enter an email');
                return;
            }
            if (!app) {
                alert('Please select an app');
                return;
            }

            // Generate license key
            const licenseKey = generateLicenseKey();
            
            // Get current URL base
            const baseUrl = window.location.origin + window.location.pathname.replace('link-generator.html', '');
            
            // Create activation URL
            const params = new URLSearchParams({
                key: licenseKey,
                app: app,
                name: name
            });
            
            currentLink = `${baseUrl}beta-activate.html?${params.toString()}`;
            
            // Store in localStorage for tracking
            const testers = JSON.parse(localStorage.getItem('beta_testers') || '[]');
            
            const sharedDate = new Date().toISOString();
            const expiresDate = new Date(Date.now() + parseInt(days) * 24 * 60 * 60 * 1000).toISOString();
            
            testers.push({
                id: Date.now(),
                name,
                email,
                phone,
                app,
                licenseKey,
                sharedDate,
                expiresDate,
                daysValid: parseInt(days),
                status: 'pending',
                daysActive: 0,
                feedback: null,
                sharedBy: 'Troy Walker'
            });
            
            localStorage.setItem('beta_testers', JSON.stringify(testers));
            
            // Create message
            const appName = getAppName(app);
            currentMessage = `Hey ${name}! ðŸš€\n\nI've been building this awesome app platform and I'd love your feedback! I'm giving you FREE access to ${appName} for ${days} days.\n\nJust click this link to activate:\n${currentLink}\n\nLet me know what you think!\n\n- Troy`;
            
            // Display
            document.getElementById('generatedLink').innerText = currentLink;
            document.getElementById('messagePreview').innerText = currentMessage;
            document.getElementById('linkResult').classList.remove('hidden');
            
            // Scroll to result
            document.getElementById('linkResult').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function generateLicenseKey() {
            return 'BETA-' + Math.random().toString(36).substring(2, 10).toUpperCase() + '-' + Date.now().toString(36).toUpperCase();
        }

        function getAppName(app) {
            const names = {
                'papi': 'AI Assistant Pro',
                'automation': 'Automation Hub',
                'aegis': 'Aegis Guard',
                'aegis_gov': 'Aegis Government Security',
                'callsentry': 'CallSentry AI',
                'nk': 'No Knowledge Kit',
                'bundle': 'the FULL BUNDLE (all apps!)'
            };
            return names[app] || app;
        }

        function copyLink() {
            navigator.clipboard.writeText(currentLink).then(() => {
                const btn = event.target.closest('button');
                const originalHTML = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check mr-2"></i> COPIED!';
                btn.classList.remove('bg-green-600', 'hover:bg-green-500');
                btn.classList.add('bg-green-400');
                
                setTimeout(() => {
                    btn.innerHTML = originalHTML;
                    btn.classList.remove('bg-green-400');
                    btn.classList.add('bg-green-600', 'hover:bg-green-500');
                }, 2000);
            }).catch(() => {
                alert('Failed to copy. Please select and copy manually.');
            });
        }

        function sendEmail() {
            const email = document.getElementById('email').value;
            const subject = encodeURIComponent('Your FREE Beta Access to PAPI Central! ðŸš€');
            const body = encodeURIComponent(currentMessage);
            
            window.location.href = `mailto:${email}?subject=${subject}&body=${body}`;
        }

        // Auto-fill from URL params if coming from admin
        window.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            if (params.get('name')) document.getElementById('name').value = params.get('name');
            if (params.get('email')) document.getElementById('email').value = params.get('email');
            if (params.get('phone')) document.getElementById('phone').value = params.get('phone');
            if (params.get('app')) document.getElementById('app').value = params.get('app');
            if (params.get('days')) document.getElementById('days').value = params.get('days');
        });
    </script>
</body>
</html>
